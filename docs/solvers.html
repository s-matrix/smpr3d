---

title: fasta algorithm


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "nbs/10a_solvers.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/10a_algorithm_fasta.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fasta2" class="doc_header"><code>fasta2</code><a href="https://github.com/s-matrix/smpr3d/tree/master/smpr3d/algorithm.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fasta2</code>(<strong><code>s_meta</code></strong>:<a href="/smpr3d/core.html#SMeta"><code>SMeta</code></a>, <strong><code>A</code></strong>, <strong><code>AH_S</code></strong>, <strong><code>AH_Psi</code></strong>, <strong><code>AH_r</code></strong>, <strong><code>prox_data</code></strong>, <strong><code>Psi_gen</code></strong>:<code>Module</code>, <strong><code>a</code></strong>:<code>Tensor</code>, <strong><code>S0</code></strong>:<code>Tensor</code>, <strong><code>Psi0</code></strong>, <strong><code>C0</code></strong>:<code>Tensor</code>, <strong><code>Ap0</code></strong>:<code>Tensor</code>, <strong><code>r0</code></strong>:<code>Tensor</code>, <strong><code>opts</code></strong>, <strong><code>S_sol</code></strong>:<code>Tensor</code>=<em><code>None</code></em>, <strong><code>Psi_sol</code></strong>:<code>Tensor</code>=<em><code>None</code></em>, <strong><code>r_sol</code></strong>:<code>Tensor</code>=<em><code>None</code></em>, <strong><code>summary</code></strong>:<code>SummaryWriter</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Block coordinate descent for scanning diffraction experiments with the latent variables
S: represents the sample, Psi: represents the incoming wave function, r: represents the scanning positions</p>
<p>:param A:        multi-linear forward operator. must be callable with 3 parameters: A(S, Psi, r)
:param AH_S:     adjoint of the linear forward operator A_S with all variables fixed but S. Must be callable with 3 parameters: AH_S(z, Psi, r)
:param AH_Psi:   adjoint of the linear forward operator A_Psi with all variables fixed but Psi. Must be callable with 3 parameters: AH_Psi(z, S, r)
:param AH_r:     adjoint of the linear forward operator A_r with all variables fixed but r. Must be callable with 3 parameters: AH_r(z, S, Psi)
:param prox_data:proximal operator for the data term
:param Psi_gen:      a function that creates the Fourier space probe from aberration coefficients C
:param a:        float (D, K, MY, MX) measured amplitudes
:param S0:       float (B_tile, NY, NX, 2) initial S-matrix
:param C0:       float (12, D) initial aberration coefficients
:param A0:       float (D, MY, MX) initial apertures
:param r0:       float (D, K, 2) initial positions
:param opts:     dictionary of optimization options
:param S_sol:    optional, float (B_tile, NY, NX, 2) initial S-matrix
:param Psi_sol:  optional, float (D, MY, MX, 2) initial probes
:param r_sol:    optional,float (D, K, 2) initial positions
:param summary:  optional, tensorboard summary writer, used to write intermediate results to tensorboard for vizualisation
:return: tuple (S, Psi, r), outs, opts
            outs is a dictionary with the keys "R_factors"
                if a S_sol is provided it has a key "S_errors"
                if a Psi_sol is provided it has a key "Psi_errors"</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

